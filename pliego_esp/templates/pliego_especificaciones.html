{% extends "base_chat.html" %}
{% load static tailwind_tags %}

{% block meta %}
{% endblock %}

{% block css %}
    {% tailwind_css %}
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
{% endblock %}

{% block title %}
Pliego de Especificaciones
{% endblock %}

{% block content %}

    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <h1 class="text-3xl font-bold text-dark-text mb-6">Asistente de Pliego de Especificaciones</h1>
        
        <div class="bg-dark-card rounded-lg shadow-lg overflow-hidden border border-gray-700">
            <div class="p-6">
                <div class="prose prose-invert max-w-none">
                    <h2 class="text-xl font-semibold text-dark-text mb-4">Resultado:</h2>
                    <div class="bg-gray-800 p-4 rounded-md border border-gray-700">
                        <article id="response-content" class="prose lg:prose-xl">
                        </article>
                    </div>
                    
                    <div class="mt-4 text-sm text-gray-400">
                        <p>Costo de tokens: {{ token_cost }}</p>
                        <p class="mt-1">ID de conversación: {{ conversation_id }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const markdownContent = `{{ response|safe }}`;
        const responseContent = document.getElementById('response-content');
        
        // Configurar marked para manejar saltos de línea
        marked.setOptions({
            breaks: true,
            gfm: true
        });
        
        // Renderizar el contenido markdown
        responseContent.innerHTML = marked.parse(markdownContent);
    });
</script>
{% endblock %}
